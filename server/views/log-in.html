<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="icon" type="image/png" href="/imgs/logo.png">
    <link rel="manifest" href="/assets/site.webmanifest" />

    <link rel="stylesheet" href="../assets/css/libs/bootstrap.min.css">
    <link rel="stylesheet" href="../assets/css/page_styles/page_signup.css">
    <link rel="stylesheet" href="../assets/css/libs/sweetalert2.min.css">


    <title>Remi Log-in</title>
</head>
<body>
    <div id="loader">
        <div class="spinner"></div>
    </div>

    <style>
        #loader {    display: flex;    justify-content: center;    align-items: center;    position: fixed;    z-index: 9999;    width: 100%;    height: 100%;    background-color: #f3f3f3;}  .spinner {    border: 16px solid #f3f3f3;    border-top: 16px solid orange;    border-radius: 50%;    width: 120px;    height: 120px;    animation: spin 2s linear infinite;}  @keyframes spin {    0% { transform: rotate(0deg); }    100% { transform: rotate(360deg); }}
    </style>

    <div id="left-section">
        
        <div id="form-container">
            <div class="alert alert-danger" role="alert" style="display: none; visibility: hidden;">
            </div>

            <span id="form-container-text">Log-In</span>
            <input type="email" name="email" id="input-email" placeholder="Email" required/>
            <input type="password" name="password" id="input-password" placeholder="Password" required/>
            <button type="button" id="form-submit" onclick="logIn()">Log-In</button>
            <a href="/signup" id="link_to_page">If you not have account - SignUp</a>
        </div>
    </div>
    <div id="right-section">
        <div id="right-img" style="background-image: url(/assets/images/pexels-francesco-ungaro-2835436.jpg);"></div>
    </div>

    <style>
        #form-submit:hover { background-color: #226b8a; }
    </style>


    <!-- <script src="../resources/js/bootstrap.min.js"></script>
    <script src="../resources/js/bootstrap.bundle.min.js"></script> -->
    <script src="../assets/js/libs/jquery-3.6.3.min.js"></script>
    <script src="../assets/js/libs/sweetalert2.all.min.js"></script>

    <script src="../assets/js/auth/app.authorization.js"></script>

    <script>
        window.addEventListener("load", function() {
          var loader = document.getElementById('loader');
          loader.style.display = 'none';
        });
    </script>

<script src="../assets/js/auth/app.validate.js"></script>

<script src="../assets/js/auth/app.authorization.js"></script>

<script>
    window.addEventListener("load", function() {
      var loader = document.getElementById('loader');
      loader.style.display = 'none';
    });
</script>

<script>
    $(document).ready(function() {
        $('#form-submit').on('click', function() {

            var email = $('#input-email').val();
            var password = $('#input-password').val();

            // console.log(email, password, passwordConfirm);

            if (!validateEmail(email)) {
                reportCustomVaildity(document.getElementById('input-email'), "It's not a valid email! Example: example@example.com");

            } else {
                if (!validatePassword(password)) {
                    reportCustomVaildity(document.getElementById('input-password'), "Your password must have length: 8-20, Uppercase letter, numbers and symbols");
                } else {
                    let authRequest = authorizationRequestBuilder({type: "login", email: email, password: password});

                    if (authRequest.status != "error") {
                        buildCookie({
                            cookieName: "_UUID",
                            cookieValue: authRequest.uuid,
                            cookiePath: "/",
                            cookieExpires: null,
                        });

                        buildCookie({
                            cookieName: "_atoken",
                            cookieValue: authRequest.token,
                            cookiePath: "/",
                            cookieExpires: null,
                        });

                        window.location.href = '/';

                    } else {

                        Swal.fire({
                            icon: 'error',
                            title: 'Oops...',
                            text: authRequest.message,
                        });

                    }
                }
            } 
        });
    });
</script>
</body>
</html>